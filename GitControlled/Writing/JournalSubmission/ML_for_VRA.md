---
title: "Machine Learning Methods for Site-specific Input Management"
author:
  - Shunkei Kakimoto^[University of Nebraska Lincoln, Department of Agricultural Economics, email; skakimoto3@hunskers.unl.edu], Taro Mieno^[University of Nebraska-Lincoln, Department of Agricultural Economics, email; tmieno2@unl.edu], Takashi S. T. Tanaka^[Gifu University, Artificial Intelligence Advanced Research Center, Faculty  of Applied Biological Sciences, email; takashit@gifu-u.ac.jp], and David S. Bullock^[University of Illinois at Urbana-Champaign, Department of Agricultural and Consumer Economics, email; dsbulloc@illinois.edu]

output:
  bookdown::word_document2:
    fig_caption: yes
    number_sections: no
    # pandoc_args: ["-Fpandoc-crossref"]
bibliography: ML_VRA.bib
csl: computers-and-electronics-in-agriculture.csl
eqnPrefix: 
      - "Eq"
abstract: "Estimating site-specific crop yield response to changes in input (e.g., seed, fertilizer) management is a critical step in making economically optimal site-specific input recommendations. Past studies have attempted to estimate yield response functions using various Machine Learning (ML) methods, including the Random Forest (RF), Boosted Random Forest (BRF), and Convolutional Neural Network (CNN) method. This study proposes use of the Causal Forest (CF) model, which is one of the emerging ML methods that comprise “Causal Machine Learning.” Unlike previous prediction-oriented ML methods, CF focuses strictly on estimating heterogeneous treatment effects of input, rather than predicting yield. We report results of using Monte Carlo simulations assuming various production scenarios to test the effectiveness of CF in estimating site-specific economically optimal nitrogen rates (EONR), comparing CF with the prediction-oriented ML methods RF, BRF, and CNN. CF's estimations of site-specific EONRs were superior under all scenarios considered. We also demonstrate that models’ ability to predict yield well does not necessarily translate to a good performance in predicting EONR."  
---







# Introduction

<!-- + background on nitrogen management (economics, environment, precision agriculture)   -->

<!-- The modern agricultural production system which is featured by the enlargement of fields due to capital-labor substitution, has been confronting the difficulty of considering the spatial and temporal within-field heterogeneity of crop management[@zhang2002precision]. Precision agriculture(PA) is the combination of technologies and practices developed to assist decision-making for such complicated management utilizing the power of information technology[@cook1998precision; @finger2019precision]. One of the leading PA technologies is variable rate application(VRA), and it has been actively investigated for site-specific input management, especially for nitrogen and seed management [@Khosla2002; @shanahan2004feasibility; @ruffo2006site; @koch2004economic; @ping2008site; @shanahan2008responsive; @munnaf2020site ;@munnaf2021map].
Efficient management of N fertilizer is a critical component of crop production from the agronomic, economic, and environmental standpoints. Inappropriate amount or timing of N application adversely affects both biomass yields and grain quality for some crops. Furthermore, inefficient use of N fertilizer not only results in economic loss but causes ambient environmental degradation[@blumenthal2008importance; @dinnes2002nitrogen; @tremblay2006adapting]. \ -->

Despite the potential economic and environmental benefits of site-specific input (e.g., nitrogen (N), seed) management, the adoption rate of variable rate application technology remains relatively low [@lowenberg2019setting]. This is primarily because it is challenging to know site-specific yield response functions accurately within a field, which is critical to identify site-specific economically optimal input rates (EOIR). As pointed out by @bullock1998does, the success of VRA is limited without accurate information regarding the site-specific yield responses. Historically, site-specific yield response functions have been estimated using the data generated from experiments conducted on only part of the field, via strip trials [@makowski2001statistical; @scharf2002corn; @bullock2002adding; @mamo2003spatial; @hurley2004estimating; @anselin2004spatial; @scharf2005field; @ruffo2006site; @Miao2006; @puntel2019development]. 

But recently whole-field on-farm precision experimentation (OFPE) has allowed implementation of improved statistical experimental designs (e.g., Latin Square, Randomized Block) are used for an entire field [@laurent_kyveryga_makowski_miguez_2019; @licht_witt_2019]. Data generated from whole-field OFPEs typically have greater local variation in experimental input application rates and soil/field characteristics than do designs implemented in earlier studies, which has improved the statistical identification of heterogeneous impacts of input management changes on yields. The resultant availability of more spatially detailed experiment data, has encouraged a resurgence of interest in estimating site-specific yield response functions. For example, @barbosa2020modeling, @krause2020random and @Gardner21 used data generated from on-farm precision experiments (OFPEs) [@bullock2019] to estimate site-specific yield response functions and economically optimal site-specific N fertilizer and/or seed rates. These recent studies used machine learning (ML) methods extensively in place of more traditional parametric modeling approaches. @barbosa2020modeling applied Convolutional Neural Network, @krause2020random used Random Forest-based approaches, and @Gardner21 used the shape-constrained generalized additive model. But this trend of applying ML methods may raise concerns. Historically, agronomy is a field that has paid meticulous attention to identifying the "causal" impacts of input management on yield through clever experimental designs. Meanwhile, recent applications of ML methods pay little attention to causal identification of inputs on yield, instead validating their models by yield prediction accuracy.  However, the ultimate goal of OFPEs is the accurate prediction of EOIR, not yield.  These are distinct objectives, and achievement of one need not imply the other.

The lack of and need for causal interpretation from ML methods has been increasingly recognized in many scientific fields, including economics and medicine. [@athey2017beyond; @athey2018impact; @Athey2019a; @moraffah2020causal; @Storm2020; @arti2020research; @scholkopf2021toward]. In response, causal machine learning (CML) methods recently have been developed. Unlike traditional prediction-oriented ML methods, CML focuses on identifying causal impacts of an event (in our context, an increase or decrease in the input application rate). The growing academic literature applying CML methods includes @richens2020improving, who pointed out that the inability of the traditional ML methods to identify cause and effect relationships between disease and patients' characteristics could lead to misdiagnoses, and showed that CML-based diagnoses could improve the accuracy of prediction of diagnoses. In addition, @carbo2020machine used a CML to identify characteristics causing bank customers to adopt online banking services. @bozorgi2020process applied CML to study the mining processes.

In the following, we improve the accuracy of estimating site-specific economically optimal N fertilization rates (EONRs) by applying @Wager2018a's and @athey2016recursive's Causal Forest (CF) CML method to identify causality in the highly complex biological process of yield response to N application rates in the presence of varying crop field characteristics (e.g., soil organic matter content). 
We propose two potential variants of CF-based methods of estimating binary treatment effects based on several input application rates used in the experiment. We compare the performances of our "CF-base" and "CF-stepwise" to the currently widely accepted Random Forest (RF), Boosted Random Forest (BRF), and Convolutional Neural Network (CNN) ML methods. We also test how yield prediction performance is related to EONR prediction performance. We use Monte Carlo simulations in which yield and soil/field characteristics datasets are synthetically generated. It is important to note that because the real-world "true" EOIR cannot be measured, real-world data cannot be used to test the accuracy of statistical methods estimating EOIRs. This important difference contrasts starkly with yield prediction, since actual yields can be ground-truthed.

Our simulation results reveal that CF-based approaches provide superior performance in site-specific EOIR estimation. We also demonstrate that a method's yeidl prediction accuracy is not a good indicator of its EOIR estimation accuracy.


# Predicting Yield vs. Predicting Changes in Yield in Response to Changes in Input Management

Next we describe the fundamental information necessary to identify EOIR: the site-specific treatment effect of input application on yield. We then describe the causal forest method in detail and show how it is particularly suitable to obtain the fundamental information, while contrasting it to more traditional prediction-oriented ML methods, such as RF, BRF, and CNN.

## A Simple Profit-maximization Problem

Letting $p$ be the price that a producer receives for a unit of a crop, $w$ be the per-unit price paid for a unit of an input, $OC$ represent other costs of production, and $y=f(I, \mathbf{c})$ the relationship describing crop yield depends on the input application rate $I$ and a vector of field characteristics variables $\mathbf{c}$, a simple model of producer behavior assumes that the producer chooses a level of $I$ to maximize profits (revenues minus costs):

\begin{equation}
\underset{\mathrm{I}}{max} \quad pf(I, \mathbf{c}) - wI -OC. (\#eq:eqn1)
\end{equation}

Elementary calculus shows that the necessary condition for maximization is, that $\partial f(I, \mathbf{c})/\partial I - w =0$, which can be rearranged as,

\begin{equation}
\frac{\partial f(I, \mathbf{c})}{\partial I} = \frac{w}{p}. (\#eq:eqn2)
\end{equation}


Eq. \@ref(eq:eqn2) states that the necessary elements of the information needed for profit maximization are the input price, the output price, and the partial derivative of the yield function with respect to the input. While knowledge of the yield function $f(I, \mathbf{c})$ in Eq. \@ref(eq:eqn1)) is sufficient to solve the maximization problem above (since its derivative can be calculated), the condition Eq. \@ref(eq:eqn2)) shows that that it is not a necessary condition; rather, knowing the function's partial derivative is necessary.  In the following, we discuss a method of using Causal Forest methods that can provide statistical advantages to the estimation of economically optimal input application rates because it is built to estimate approximations of the derivative $\partial f/\partial I$, and not the yield function $f$ itself.

## Estimating EOIR and Treatment Effects

Recent papers using ML methods to estimate the effectiveness of various agricultural input management strategies have based their analyses on estimates of a yield function, $f(I, \mathbf{c})$ (e.g., @krause2020random; @barbosa2020modeling; @Gardner21). In following, we present a Causal Forest methodology that does not rely on estimation of how the level of yield depends on the input application rate $I$, but but rather relies on a discrete version of Eq. \@ref(eq:eqn2), examining the discrete changes in yield that result from discrete *changes* in the input application rate $I$. 

Consider an increasing ordering of input application rates $I_1, I_2,...,I_K$. Among these K rates, for a generic site $i$ a specific EOIR can be identified if the *treatment effect* function $\Delta y_i(I_{k+1}, I_{k})$ is known. This function is defined as the discrete change in yield that results from a discrete change in the input level from $I_k$ to $I_{k+1}$, and it depends on the characteristics at the site analyzed: 

$$
\Delta y_i(I_{k+1}, I_{k}) = f(I_{k+1}, \mathbf{c_i}) - f(I_{k}; \mathbf{c_i}) \quad ^\forall k = 1, \dots , K - 1
$$

Once treatment effects $\Delta y_i(I_{k+1}, I_{k})$ have been identified for every $k$, economic analysis can be conduced to identify the EOIR for site $i$. The profit change from increasing the input rate from $I_{1}$ to $I_{k}$ is 

$$
P_c (\sum_1^{k-1} \Delta y_i(I_{k+1}, I_{k})) - P_I \times (I_k - I_0)
$$

The EOIR is the value $I_k$ that maximizes the profit gain "relative" to profits from $I_1$. ($I_1$ may be the EOIR if no other rates surpass the profit of $I_1$.)

## Causal Forest

CF was developed specifically for identifying heterogeneous treatment effects [@athey2016recursive; @Wager2018a]. Like RF, CF works by building an ensemble of trees, called *causal trees* (CT), by recursively partitioning covariate space into two leaves, where each leaf estimates conditional average treatment effects as the mean differences between the dependent variable (here, yield) of the treated and control observations that belong to the leaf. Figure \@ref(fig:ct-ex) shows an example of CT where the treatment is an increase in seed rate from $27,000$ seeds/ha (control) to $31,000$ seeds/ha (treated) with apparent electrical conductivity ($\textit{ecs}$) and $\textit{slope}$ as variables to explain the heterogeneity of the impact of the treatment. 
In the first node, all the samples ($1024$ observations) belong to the node, and the causal effect of the treatment was calculated as the difference in the mean yield of the treated and control groups, which turned out to be $593$ kg/ha in this example. The first data split criteria is whether the $\textit{ecs}$ value is greater or less than $25$. The observations with $\textit{ecs}$ greater than equal to (less than) $25$ move to the left (right) node. For each of the subsamples, the treatment effect is identified as the difference in the mean yields of the treated and control groups within the subsample. For the observations with $\textit{ecs}$ greater than equal to (less than) $25$, the treatment effect is $619$ ($982$) kg/ha. This means that the impact of the increase in seed rate has a larger positive impact on yield for those with $\textit{ecs}$ higher than $25$; in other words, the treatment effect is heterogeneous over space, depending on the value of $\textit{ecs}$. Trees are further developed to have more groups of subsamples to allow for more flexible representations of the heterogeneous treatment effects. The estimated CF model does not predict yield level at any site $i$ in the field. However, as mentioned earlier, such information is not necessary to find EOIR at each site $i$, as knowing the treatment effects is sufficient. Since CF is designed to estimate the causal effect of an input directly rather than indirectly, it seems reasonable to believe that CF outperforms other ML methods in identifying EOIR.

While both RF and CF build trees by recursively partitioning samples, they differ critically in their criteria for splitting. In RF, the sample is split to minimize the mean squared error (MSE) of yield prediction in building trees. Unfortunately, the MSE of treatment effect predictions is not usable in building a CT as the true treatment effects are never observable unlike yield. However, @athey2016recursive showed that minimizing the expected MSE of the treatment effect is equivalent to maximizing the variance of treatment effects across the resulting two leaves and minimizing the within-leaf variance. Consequently, CF overcomes the fundamental problem of never being able to observe true treatment effects by splitting samples in a way that maximizes the variance of treatment effects across the resulting two leaves. CF requires that the tree-building process is "honest" for treatment effects estimation to be unbiased. Honest tree-building first splits the training data samples into two parts randomly, uses one of the subsamples to determine how to split the tree, but uses the other subsamples to estimate the treatment effects [@athey2016recursive; @Wager2018a]. This honest subsampling technique avoids overestimating the heterogeneity of treatment effects. Since CF splits samples to maximize heterogeneity of estimated treatment effects, using the same sample for both the sample splitting and treatment effect calculations renders itself sensitive to noise or outliers, exaggerating treatment effects solely because of large noise. 

## CF vs. Prediction-oriented ML methods

The distinction made earlier between indirect (yield-prediction-first) and direct approaches can lead to meaningful statistical differences. The conventional prediction-oriented ML methods are designed to predict yield, $y_i(I,\mathbf{c})$, well, but not necessarily treatment effects. Since the loss function used in prediction-oriented ML uses (typically squared) residuals in yield prediction, prediction-oriented ML is naturally optimized for predicting the level of yield instead of identifying the causal impact of the input. 
CF, on the other hand, is designed specifically to estimate the causal impact of input. Indeed, @Wager2018a used Monte Carlo simulations to show that CF provided estimates of heterogeneous treatment effects that were superior to those provided by RF. However, CF has never been compared to more advanced ML methods such as BRF and CNN that are considered to have greater prediction capability than RF has. The study reported here builds on @Wager2018a to compare CF to these prediction-oriented ML methods (not just RF, but also BRF and CNN) in more realistic agronomic experiment settings.


# Materials and Methods

The first step in our simulation was to generate one thousand synthetic fields that "resembled" an actual field in Illinois, USA. For each simulated field, we generated a training data set and a validation data set. Field characteristics and yield were simulated based on the Mitscherlich-Baule (MB) yield response function. We used the RF, BRF, and CNN ML methods to estimate yield response functions, and we used the CF method to estimate treatment effects. For each method, we estimated site-specific EONRs using the training data set, and checked the statistical performance of the predicted site-specific EONR using the validation data set. Detailed descriptions of these steps are provided below


## Data Generation

### Simulated Experimental Fields
<!-- experimental field: area: 51ha, plot: 384, subplot:1536, cell:55296   -->
<!-- field with padding: area: 57ha, plot: 476, subplot:1700, cell:61200   -->

The corn field for the simulation was created based on an actual 51-ha Illinois field on which the Data-Intensive Farm Management (DIFM) project [@bullock2019] has run multiple on-farm precision experiments.
Figure \@ref(fig:field-map) illustrates field trials designed containing "plots," "subplots," and "cells" as spatial units; the trial consisted of $384$ 60-ft $\times$ 240-ft "plots", each of which was assigned a N fertilizer application rate. Each plot was made up of four (4-rows $\times$ 1-column) subplots. The subplot was the analysis unit used for the subsequent statistical analysis. Each subplot contained of a 6-rows $\times$ 6-columns grid of thirty-six 10-ft $\times$ 10-ft "cells." All field characteristics and yield data were generated at the cell level.


### Underlying Yield Response Function

We modeled the yield production function as having the following Mitscherlich-Baule functional form:

\begin{equation}
f(N, \mathbf{c}) = ymax(\mathbf{c})(1-exp(\alpha(\mathbf{c}) + \beta(\mathbf{c}) N)) + \varepsilon (\#eq:eqn3)
\end{equation}

The first term on the right-hand side of Eq. \@ref(eq:eqn3) is the deterministic yield component, which was generated assuming the commonly-used MB functional form, which is flexible in its shape, allows for the existence of a yield plateau, and has been shown to be a plausible specification for N fertilization models for corn [@frank1990; @llewelyn1997; @paris1992].
The variable $N$ in Eq. \@ref(eq:eqn3) represents the nitrogen fertilizer application rate (kg/ha) which the trial designs varied by plot. Also in Eq. \@ref(eq:eqn3), $\alpha$, $\beta$, and $ymax$ are functions of a vector of field characteristics variables $\mathbf{c}=(c_1,...,c_K)$, which vary spatially on the field. For example, $\alpha$ and $ymax$, which affect yield independently from the applied N fertilizer rate, might be interpreted as depending on ingerent soil N content supplied by residual N, soil organic matter, etc. $\beta$ can be interpreted as reflecting how efficiently the crop uses N to create grain mass, and might depend on soil properties that affect the availability of applied N fertilizer to the crop, say due to N immobilization, leaching, denitrification, and volatilization [@johnson2005nitrogen; @alva2006nitrogen]. The error term of the yield $\varepsilon$ represents the composite of all the unobserved factors that affect crop yield beyond $\alpha$, $\beta$, $ymax$ and $N$. 

A fictional "researcher" is modeled as having limited knowledge about which variables make up $\mathbf{c}$, or even the number of elements of, and has limited ability to measure the values that many of the variables that constitute $\mathbf{c}$ take on across the field. The researcher is also assumed to not know the functional forms of $\alpha(\mathbf{c})$, $\beta(\mathbf{c})$, and $ymax(\mathbf{c})$. 


### Cell-specific Yield Functions and Economically Optimal N Rates

Let $i \in \{1,2,...,1536\}$ index a simulated field's subplots and $j \in \{1,2,...,36\}$ index cells within a subplot. Letting $N^{i}$ be the N fertilization rate on plot $i$, and letting $\mathbf{c}^{i,j}$ be the value of $\mathbf{c}$ on cell $(i,j)$, Eq. \@ref(eq:eqn4) shows the cell-specific yield level function:

\begin{equation}
f(N^{i}, \mathbf{c}^{i,j}) = ymax(\mathbf{c}^{i,j})(1-exp(\alpha(\mathbf{c}^{i,j}) + \beta(\mathbf{c}^{i,j}) N^{i})) + \varepsilon^{i,j}. (\#eq:eqn4)
\end{equation}

To simplify notation, denote  $\alpha(\mathbf{c}^{i,j})$ as $\alpha^{i,j}$, $\beta(\mathbf{c}^{i,j})$ as $\beta^{i,j}$, and $ymax(\mathbf{c}^{i,j})$ as $ymax^{i,j}$. Then, a cell-specific yield function can be written as, 

\begin{equation}
f^{i,j}(N) = ymax^{i,j}(1-exp(\alpha^{i,j} + \beta^{i,j} N^{i})) + \varepsilon^{i,j}. (\#eq:eqn5)
\end{equation}

Parameters $\alpha^{i,j}$, $\beta^{i,j}$, $\beta^{i,j}$, and $\varepsilon^{i,j}$ were modeled as spatially autocorrelated using unconditional Gaussian geostatistical simulation based on the spherical variogram models. The parameters of the variograms were chosen to generate yields consistent with those observed in experiments conducted by the DIFM project. (Codes used to generate parameter values are available at https://github.com/tmieno2/ML_VRA.git.) 


Each cell $(i,j)$'s "true" optimal N application rate, denoted $N_{opt}^{i,j}$, was calculated by solving a profit maximization problem:

\begin{equation}
N_{opt}^{i,j} = \underset{\mathrm{N}}{argmax}(P_{C} f^{i,j}(N) - P_N N), (\#eq:eqn6)
\end{equation}

where, $P_{C}=\$3.5/kg$ and $P_{C}=\$3.5/kg$ are the assumed prices of the corn and N fertilizer. Figure \@ref(fig:fig-optN) maps an example of the identified "true" cell-specific optimal N rates. 

### Trial Design
In each simulation round, five field-trial N rates were determined based on the range of the round's cell-specific EONRs. <!-- Ordering the round's EONRs from minimum to maximum, and calling those endpoint values $N_{opt}^{min}$ and $N_{opt}^{max}$, the five trial design rates were -->
Let $Q_q$ ($q \in [0,1]$) denote $100 \times q$ percent quantile of the round's cell-specific EONRs. Then, the five trial design rates were \

$$
\begin{aligned}
N_1 &= Q_{0.05} - 20 \\
N_5 &= Q_{0.95} + 20 \\
N_2 &= N_1 + 0.25(N_5 - N_1) \\
N_3 &= N_1 + 0.50(N_5 - N_1) \\
N_4 &= N_1 + 0.75(N_5 - N_1)
\end{aligned}
$$

In each round, a Latin square design was followed to assign each plot one of the five N rates so established. Figure \@ref(fig:fig-nExp) shows an example of a trial design. Under this design, the N rate was orthogonal to the error term. This is important because it they were correlated, bias in yield response estimation would be introduced for all of the ML methods^[Since the treatment effect at each leaf is obtained simply by taking the difference of the average value of the dependent variable between the control and treated group within the leaf, CF requires the exogeneity of the treatment conditional on the independent variables to estimate the treatment effect consistently. Note that the violation of this condition leads to biased estimation for not just CF and the other ML methods, as well.].

<!-- Resulting mean yield of $1.1250\times10^4 \text{ } kg/ha$. The magnitude of the error term is set to vary yields by approximately $1245 \text{ }(kg/ha)$ on average from deterministic yields. 
 -->

### Yield Data Generation and Aggregation

For a generic cell $(i,j)$, yield $y^{i,j}$ was generated through Eq. \@ref(eq:eqn3), applying parameter values $\mathbf{c^{i,j}}=(\alpha^{i,j}, \beta^{i,j}, ymax^{i,j})$, the disturbance term level $\varepsilon^{i,j}$, and the cell's assigned experimental N rate, $N^{i,j}$ (Figure \@ref(fig:field-yield-cell)). as a result, cell-level data set for the whole field, $\{(y^{i,j}, N_{opt}^{i,j}, N^{i,j}, \mathbf{c}^{i,j}): i \in \{1,2,...,1536\}, j \in \{1,2,...,36\}\}$ was obtained. These were aggregated up to the subplot level by taking the mean of the cell-level values inside each subplot, which were the unit of observation. The subplot data were therefore 

$$
\{(y^{i}, N_{opt}^{i}, N^{i}, \mathbf{c}^{i}) = \frac{1}{36}\sum_{j=1}^{36} (y^{i,j}, N_{opt}^{i,j}, N^{i,j}, \mathbf{c}^{i,j}): i \in \{1,2,...,1536\}\}
$$

Figure \@ref(fig:field-yield-subplot) shows an example of observed yield data. Note that data generation at the cell level was conducted to reflect the real-world spatial heterogeneity in soil/field characteristics within the subplot level. But data aggregation to the subplot level was conducted because the large sizes of harvesters make it impossible to monitor yields accurately at smaller scales.


### Modeling Scenarios

To evaluate the performances of RF, BRF, CNN and CF, we examined four modeling scenarios, each defined by a dataset assumed to be available to the researcher. The first modeling scenario, called "aby" assumes that researchers have in a dataset the actual values $\alpha^{i,j}$, $\beta{i,j}$, $ymax^{i,j}$ for every cell $(i,j)$ and use $\alpha$, $\beta$ and $ymax$ as covariates in their ML models. This scenario represents an ideal situation for researchers, with which analyses of more realistic scenarios can be compared.

In subsequent modeling scenarios, we make the simulated experimental data more realistic by varying the degree to which researchers understand what the needed covariates are and the levels that they take on in the data set. In the second scenario, called "abytt", we introduce additional variables $\theta_1$ and $\theta_2$, and the researcher's dataset contains values of $\alpha^{i}$, $\beta^{i}$, $ymax^{i}$, $\theta_1^{i}$ and $\theta_2^{i}$ for all subplots $i=1,...,1536$. $\theta_1$ and $\theta_2$ have no effect on yield, but their cell-level values spatially correlated with $\beta^{i,j}$, then their subplot-level values are correlated with $\beta^{i}$. This scenario is meant to reflect the lack of scientific consensus about which variables explain heterogeneous yield response to N, making it likely that researchers include irrelevant variables like $\theta_1$ and $\theta_2$ in real-world data analysis. 

In the third scenario, called "aabbyy", the researcher's dataset does not contain values of $\alpha^{i}$, $\beta^{i}$, $ymax^{i}$. Rather, the dataset contains subplot-level values of permutations of $\alpha$, $\beta$, $ymax$. Specifically, for each cell $(i,j)$, we assign one of a set of spatially autocorrelated weights $r_{\alpha}^{i,j} \in (0,1)$ to the $\alpha$ variable, another set of spatially autocorrelated weights $r_{\beta}^{i,j} \in (0,1)$ to the $\beta$ variable, and another set of spatially autocorrelated weights $r_{ymax}^{i,j} \in (0,1)$ to the ${ymax}^{i,j}$ variable. (There was no spatial correlation between the $r_{\alpha}^{i,j}$ and $r_{\beta}^{i,j}$ data, between $r_{\alpha}^{i,j}$ and $r_{ymax}^{i,j}$ data, or between $r_{\beta}^{i,j}$ and $r_{ymax}^{i,j}$.) Six new covariates were created with the weights and the original covariates $\alpha^{i,j}$, $\beta^{i,j}$ and $ymax^{i,j}$. 
These were 
$\alpha_{1}^{i,j} = r_{\alpha}^{i,j} \alpha^{i,j}$, $\alpha_{2}^{i,j} = (1- r_{\alpha}^{i,j}) \alpha^{i,j}$,
$\beta_{1}^{i,j} = r_{\beta}^{i,j} \beta^{i,j}$, $\beta_{2}^{i,j} = (1- r_{\beta}^{i,j}) \beta^{i,j}$,
$ymax_{1}^{i,j} = r_{ymax}^{i,j} ymax^{i,j}$, and $ymax_{2}^{i,j} = (1- r_{ymax}^{i,j}) ymax^{i,j}$.
For each $\alpha$, $\beta$ and $ymax$, these procedures created two new covariates that were highly spatially autocorrelated with the original covariate, which was meant to reflect that many of the soil/field characteristics used to analyze on-farm precision experimentation data are spatially correlated. The values of $\alpha^{i,j}$, $\beta^{i,j}$ and $ymax^{i,j}$ do not indicate specific soil or field characteristics, but are functions of such. In reality, scientists cannot directly observe variables that can accurately predict yield plateau level, soil N content and N uptake efficiency. Rather, they use multiple observed soil/field characteristics to explain such phenological phenomena. For example, instead of using $ymax^{i,j}$ directly, some some topographical land features and soil properties such as elevation and soil sand content could be used as yield-limiting factors [@jiang2004effect; @kravchenko2000correlation]. In reality, scientists may include more than three variables as covariates. This scenario should reduce the accuracy of EONR modeling for all the models compared to the ideal case. 

The fourth scenario, called "aabbyytt", has the same components as aabbyy, but also includes the $\theta_1$ and $\theta_2$ covariates. 


## OFPE Experiments and Estimating Site-specific Optimal N Rates

### RF, BRF, and CNN

The RF, BRF, and CNN methods follow the same conceptual steps to estimate site-specific EONR: 1) estimate yield production functions and 2) calculate site-specific EONRs based on that estimated function. For the given modeling scenario, RF and BRF predict yield by using all the available covariates as explanatory variables in the estimation process. The `grf` package (version 1.2.0 [@tibshirani2018package] ) in R was used for RF and BRF modeling.

CNN is flexible in its modeling architecture, and there is a room for researchers to determine its architecture. In this article, a slightly modified version  of one of the multi-stream CNN architectures proposed by @barbosa2020modeling (called "Late Fusion") was used. Briefly, each input size is $6 \times 6$ (e.g. $\alpha^{i,j}$, $\beta^{i,j}$, etc.). Although the spatial resolution of input size is finer in the CNN model than the other ML models (e.g., RF, BRF, etc.), the area of each cell $(X \times X \mbox{m})$ is the same among the models. 
On the other hand, the input size of the N rate is treated as $1 \times 1$ because it is spatially homogeneous within each cell. 
First, each input was connected to an independent convolutional layer with eight $3 \times 3$ filters each with stride one, followed by a $2 \times 2$ max-pooling layer with stride two. Then, a fully-connected rectified linear unit (ReLU) layer with sixteen neurons was added after each max-pooling layer, followed by a single ReLU neuron. Finally, multiple neurons were concatenated and fed to the fully-connected ReLU layer with sixteen neurons, followed by an output with a linear activation function. @barbosa2020modeling demonstrated that this architecture had the best performance for modeling crop yield response to N rate management among several CNN architectures. CNN was implemented in Python v3.7.6 using Pytorch v1.7.0 [@paszke2017automatic]. The Adam optimizer [@kingma2014adam] was used with a learning rate of $0.001 \%$ (default value). To avoid overfitting, early stopping was used monitoring validation loss with a ten epochs of patience of $10$ epochs. 

Let $\mathbf{\Omega^{i}}$ denote a list of subplot-levle explanatory variables (soil/field characteristics). Further, let $\hat{g}_m(N,\mathbf{\Omega})$ denote an estimated yield response function by model $m$ ($m$ = RF, BRF, or CNN). Then, yield at $i$ from model $m$ is $\hat{g}_m(N,\mathbf{\Omega^{i}})$. Site-specific EONR for each model can then be found by solving the following profit maximization problem for all $i$ for each of the models:

$$
\hat{N}_{opt}^{i} =\underset{\mathrm{N}}{argmax}(P_{C} \hat{g}_m(N,\mathbf{\Omega^{i}}) - P_N N) 
$$

where $P_C$ and $P_N$ are the prices of corn and N.

### CF

Unlike RF, BRF, and CNN, CF estimates the impact of a binary treatment. In our context, CF estimates changes in yields (i.e., $\hat{\tau}_{N^{con} \rightarrow N^{tre}}(\mathbf{\Omega^{i}})$) caused by changes in N application rates from one experimental rate (i.e., $N^{con}$) to another experimental rate(i.e., $N^{tre}$). 
Since we have five N application rates, four "experiments" (treatments) are identified based on four ($N^{con}$, $N^{tre}$) combinations. 
A possible grouping to make such pairwise N application rate combinations, which we call the "CF-base", used $(N_1, N_2),(N_1, N_3),(N_1, N_4)$, and $(N_1, N_5)$. In this approach, the treatment effect is always estimated against the lowest N rate ($N_1$) as $N^{con}$^[Another potential grouping approach we considered used $(N_1, N_2),(N_2, N_3),(N_3, N_4)$, and $(N_4, N_5)$. We label this approach as the "CF-stepwise". See Appendix for the detail and the result.].

For estimating site-specific EONR, the trained CF-base were used to make predictions of site-specific changes in yields resultant from changes in application rates from $N_1$ to $N_m$ $(m\in\{2,3,4,5\})$. Let $\Delta Y_{N_1 \rightarrow N_m}(\mathbf{\Omega^{i}})$ be the the estimated treatment effect of changing subplot $i$'s application rate from $N_1$ to $N_m$ for site $i$. 

Since CF-base approach always estimates the treatment effects using the lowest treatment rate $N_1$, the predicted treatment effects already represent the change in yields from the yield at $N_1$:

$$
\Delta Y_{N_1 \rightarrow N_m}(\mathbf{\Omega^{i}}) = \hat{\tau}_{N_{1} \rightarrow N_{m}}(\mathbf{\Omega^{i}})
$$

Once the treatment effects from the base were obtained, site-specific EONRs were identified by finding the N rate that leads to the highest profit. Yield levels were not predicted at any point in the CF-based approaches. 

<!-- We consider two possible groupings to make such pairwise N application rate combinations.  The first grouping approach, which we call the "CF-base", used $(N_1, N_2),(N_1, N_3),(N_1, N_4)$, and $(N_1, N_5)$. In this approach, the treatment effect is always estimated against the lowest N rate ($N_1$) as $N^{con}$. The second grouping approach used $(N_1, N_2),(N_2, N_3),(N_3, N_4)$, and $(N_4, N_5)$. We label this approach as the "CF-stepwise". 
For estimating site-specific EONR, the trained CF-base and CF-stepwise methods were used to make predictions of site-specific changes in yields resultant from changes in application rates from $N_1$ to $N_m$ $(m\in\{2,3,4,5\})$. Let $\Delta Y_{N_1 \rightarrow N_m}(\mathbf{\Omega^{i}})$ be the the estimated treatment effect of changing subplot $i$'s application rate from $N_1$ to $N_m$ for site $i$. 
In the CF-stepwise approach, this value can be calculated by sequentially adding the estimated treatment effects: 
$$
\Delta Y_{N_1 \rightarrow N_m}(\mathbf{\Omega^{i}}) = \sum_{k=1}^{m-1} \hat{\tau}_{N_{k} \rightarrow N_{k+1}}(\mathbf{\Omega^{i}})
$$
In the CF-base approach, the treatment effects were always estimated using the the lowest treatment rate $N_1$. Therefore, the predicted treatment effects already represent the change in yields from the yield at $N_1$:
$$
\Delta Y_{N_1 \rightarrow N_m}(\mathbf{\Omega^{i}}) = \hat{\tau}_{N_{1} \rightarrow N_{m}}(\mathbf{\Omega^{i}})
$$

Once the treatment effects from the base were obtained, site-specific EONRs were identified by finding the N rate that leads to the highest profit. Yield levels were not predicted at any point in the CF-based approaches.  -->

RF, BRF, and CF of `grf` package have several tunable hyperparameters (e.g., the minimum node size in each tree, the number of covariates used for node splitting, and parameters involving honest tree-building process), and the optimal values for these parameters are selected by cross-validation. In addition to these tuning parameters, we need to set the number of trees grown in a forest (i.e., *num.trees*). Individual tree in a forest is built with randomly subsampled observations, and therefore the prediction is different every time we build a forest even if we use the same dataset. To reduce the variance of predictions, in other words, to stabilize the prediction accuracy, we need to set a large number of *num.trees*. For this study, we set *num.trees* to $4000$.

### Model Evaluation

The accuracy of EONR estimation is judged based RMSE of EONR estimation against the true EONR at the subplot level. In addition, using the EONR estimates, we calculate profit loss ($\$/ha$) (i.e., $\hat{\pi}_{loss}$) relative to maximized profit at the subplot level. The maximized profit is the profit under the yield from MB function at $N_{opt}^{i}$. For RF, BRF, and CNN, the accuracy of yield prediction was judged based on the RMSE of the yield prediction against the true yields at the subplot level. 

# Results and Discussions

## EONR Estimation

Table \@ref(tab:table-optN-subplot-wide) shows the mean RMSE of the EONR estimation and $\hat{\pi}_{loss}$ over the $1000$ simulations, and makes immediately clear that CF-base considerably outperformed the other ML methods and the attained profits based on CF-base's EONR estimates were the closest to the maximized profits. BRF performed considerably better predicting EONR than did RF. Interestingly, CNN completely failed in its estimations of site-specific EONRs. This happened because the site-specific yield response functions identified by CNN were linear, and all with the same slope. Therefore, CNN failed to capture a declining marginal product of N. The constant marginal product caused the estimated EONR to take on either the lowest or highest N application rate. To examine whether this problem is only for the choice of specific CNN architecture, we also tested another CNN model, which was analogous to CNN-ST proposed by @barbosa2020modeling. 
This architecture also estimated that yield and N rates were perfectly linearly related, and also estimated site-specific EONR poorly. Note that @barbosa2020modeling just compared models through the lens of yield prediction but did not derive EONR from any of the estimated models. According to our simulation, CNN may perform well in predicting yield in some cases, but it completely failed in predicting EONR well.

Figure \@ref(fig:dist-optN) and Figure \@ref(fig:dist-piLoss) show the distributions of the one thousand RMSE of the EONR estimates and $\hat{\pi}_{loss}$ by ML methods and modeling scenarios, respectively. The center of distribution mass of the CF-base's RMSE values and $\hat{\pi}_{loss}$ are to the left of the centers of the distribution masses of the other methods' RMSE values, showing that CF-base more accurately and consistently estimated EONR across all the modeling scenarios. Interestingly, RF seems particularly vulnerable to the inclusion of more variables, with RMSE ($\hat{\pi}_{loss}$) decreasing from 45.3 (29.39) in the "aby" scenario to 50.6 (37.44) in the "aabbyytt" scenario. CF-base was more robust to the inclusion of additional variables. Overall, the simulations present CF-base is the clear winner in estimating EONR. 

Figure \@ref(fig:plot-tre) illustrates the underlying cause of CF-bases superior predictions of EONR. It plots the estimated treatment effects against true treatment effects by treatment type and ML model (RF, BRF, and CF-base) under "aabbyytt" case in one of the $1000$ simulations rounds to illustrate differences between the ML models. The figure shows that the estimated treatment effects did not exhibit significant bias, with the points clustered around the 1-to-1 line (red line in the figure). However, they differ substantially in the accuracy of treatment effect estimation. Points are clustered much more tightly about the 1-to-1 line much for CF-base than RF and BRF. That is, CF-base is much more efficient in estimating treatment effects compared to the RF and BRF that focus on yield prediction rather than treatment effect estimation.

## Yield Prediction and EONR Estimation

For RF, BRF and CNN, Figure \@ref(fig:plot-y-optN) plots the RMSE values of EONR estimation against the RMSE values of yield prediction, and for all the models shows little if any correlation between the two measures. In other words, the quality of a model's yield predictions provides little if any information about the quality of its EONR predictions. 

Table \@ref(tab:table-y-subplot-wide) shows the mean RMSE of yield prediction over the $1000$ simulations. Since CF-base do not predict yield, the table only reports the results from RF, BRF and CNN. 
Compared to the result of EONR estimation, RF performed as well as BRF in the simple modeling scenarios of "aby" and "abytt." This fact along with the poor performance of RF in predicting EONR show that strong predictive power of yield levels does not strong prediction of EONR. Further, RF shows vulnerability to the inclusion of many correlated variables, as is displayed for EONR prediction as well. While CNN performs worse than RF and BRF at "aby" and "abytt," it performs better than RF in more complicated modeling scenarios, showing robustness, at least in yield prediction, to inclusion of many correlated variables. Of course, while CNN performs better in yield level prediction than RF on average in "aabbyy" and "aabbyytt," CNN performs worse than RF in predicting EONR, which further backs our claim that a good yield prediction capability does not imply good EONR prediction capability.

<!-- To examine the discrepancy between yield prediction performance and EONR estimation performance, for each modeling scenario we counted the number of simulation rounds in which a single ML method consistently showed the highest R-squared in both yield prediction and EONR estimation. 
Table \@ref(tab:count-table) shows the results. The numbers shown in parentheses indicate the total number of simulation rounds in which the corresponding ML method showed the highest R-squared in yield prediction. For example, the table shows that, in the "aby" scenario, RF attained the highest R-squared for yield prediction in $364$ of $1000$ iterations, and RF attained the highest R-squared for EONR estimation in $62$ of $364$ iterations. That is, in $302$ out of $364$ rounds, the RF models with the highest yield prediction performances did not lead to the highest EONR estimation performances. If the model with the highest yield predictive performance is likely to result in the highest EONR estimation performances as well, the two numbers should be close. As such an example, BRF of "aabbyytt" case attained the highest R-squared for yield prediction $584$ times and achieved the highest R-squared for EONR estimation $527$ times out of $584$ rounds.
The "Total" column shows the total count of simulation rounds where a single model exhibited the highest R-squared for both EONR and yield predictions. Those numbers are almost less than $500$, indicating that if you are to rely on R-squared for yield prediction to select your model, then there is about $50\%$ chance that you would be dismissing the model with the highest R-squared for EONR prediction. -->

Virtually all the previous studies have used have used yield prediction accuracy to rank models. This is understandable, given that we never know the true causal impact of a treatment, making it impossible to conduct cross-validation on EONR. On the other hand, yield can be "ground-truthed." However, our simulation results clearly show that using model yield prediction accuracy as a model selection criteria is not well justified if the ultimate objective is accurate estimation of site-specific EONR.


<!-- ## CF-stepwise and CF-base

Even though CF-stepwise and CF-base used the same ML method, the performance of CF-stepwise was considerably poorer than CF-base's. To examine this problem in more detail we conducted simulations to investigate how accurately CF-stepwise and CF-base can predict the treatment effects for each $(N^{con}, N^{tre})$ combination on independent validation data sets. We used the same data and ran $1000$ rounds of simulations. In each simulation round, the R-squared of estimated treatment effects was calculated. Table \@ref(tab:te-res-summary) reports the resultant mean of R-squared. While the accuracy of treatment effect estimation from CF-base improves as N treatment rates increases, the accuracy of CF-stepwise became gradually worse. 

Generally, the slope of the yield response curve to N rate diminishes as N rate increases, and the shape of the curve starts to almost flatten out around the high N application rate of $N_4$ and $N_5$. Consequently, the observed differences in yield between two successive N rates are progressively dominated by noise rather than by the treatment effect signal, making it progressively harder as the N rate increases for CF-stepwise to estimate the treatment effects. On the other hand, the arrangement of treatment groups by CF-base provides sufficient signaling because the baseline N rate is always the lowest N rate. -->

# Conclusion

ML methods are appealing tools that can potentially improve site-specific input rate management by capturing heterogeneous treatment effects introduced by complex non-linear and multidimensional interactions of soil and field characteristics. While many kinds of prediction-oriented ML methods have been used for this purpose, we used CF in this study. CF is a relatively new ML method, and it focuses on identifying heterogeneous causal effects of treatment, unlike prediction-oriented ML methods.

We examined the uses of CF-stepwise and CF-base for site-specific input management recommendations. Using Monte Carlo simulations under various modeling scenarios, we compared the CF estimations of site-specific EONR to those of the prediction-oriented ML methods RF, BRF, and CNN. CF_base consistently outperformed the other methods across all the modeling scenarios. CF-stepwise performed worse than CF-base because its estimation process was more sensitive to noise than was CF-base's. We also showed that the model's yield prediction accuracy was uncorrelated with its EONR prediction accuracy, and so yield prediction accuracy should not be used as a model selection criteria. 

Despite the relatively simple nature of the simulations, results reported provide intriguing evidence of potential advantages of CF over other ML methods when the purpose of the research is to increase the economic efficiency of input management. Of course, the reported research did not model all situations, and further research is needed. First, a drawback of the CF method is that because it does not estimate a continuous yield response function, it can only compare the economic outcomes of a limited set of experimental N rates included in the field trial that provides the data. This raises important questions about trial design. How many distinct experimental input application rates should be included?  All the trial designs examined here were based on five N rates. Having examined models with additional rates would have increased the number of possible N rates from which the EONR were selected, but reduced treatment pair replications and so the estimation accuracy.

Second, the size of the field used in the OFPE can affect the relative performances of the competing methods. CF requires honest sampling for its unbiasedness property. Honest sampling comes at the cost of losing prediction accuracy of treatment effects because fewer samples are used to estimate treatment effects within leaves [@athey2016recursive]. Therefore, if the ML analyses are conducted with OFPE data from a small field, CF may not outperform other ML methods

Third, another interesting subject future research is the potential of combining the ML methods with post-estimation spatial smoothing of the estimated EONR. It is a well known fact that soil/field characteristics are spatially correlated [@f2007methods;@goovaerts1999geostatistics]; this spatial correlation is likely to cause spatial correlation in EONRs, which would suggest that post-estimation spatial smoothing of EONRs may further improve the accuracy of EONR estimation.

Finally, a natural and fruitful extension of the reported research would be to test CF and other ML methods in a dynamic setting where multiple years of experiments are conducted, allowing weather events into the analysis as explanatory variables. Crop simulation models (e.g., APSIM, DSSAT, etc.) could be used in place of the Mitscherlich-Baule production function used here to model the underlying yield response function, which could generate more realistic data, using actual soil/field characteristics and weather instead of abstract parameters in the analysis, and so better include the dynamic nature of cropping systems in the study of N management [@archontoulis2020predicting;@puntel2016modeling;@puntel2018systems].

# Acknowledgements

This research was supported by a USDA-NIFA-AFRI Food Security Program Coordinated Agricultural Project, titled “Using Precision Technology in On-farm Field Trials to Enable Data-Intensive Fertilizer Management,” (Accession Number 2016-68004-24769), and also by the a USDA-NRCS Conservation Innovation Grant from the On-farm Trials Program, titled “Improving the Economic and Ecological Sustainability of US Crop Production through On-Farm Precision Experimentation” (Award Number NR213A7500013G021). 

\newpage



# Tables

<br>


<div class="tabwid"><style>.cl-ce816938{border-collapse:collapse;}.cl-ce7e7a8e{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ce7e7a98{font-family:'Helvetica';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;top:3.3pt;}.cl-ce7e866e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ce7e8678{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ce7eae3c{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eae46{width:21.6pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eae50{width:62.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eae51{width:62.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eae5a{width:52.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eae64{width:45pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eae65{width:21.6pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eae6e{width:52.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eae6f{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eae78{width:62.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eae79{width:45pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eae8c{width:62.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eae8d{width:62.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eae96{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eaea0{width:21.6pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eaea1{width:52.3pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eaea2{width:45pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eaeaa{width:62.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eaeb4{width:52.3pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eaeb5{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eaebe{width:21.6pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eaebf{width:62.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eaec8{width:45pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eaed2{width:62.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eaed3{width:21.6pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eaedc{width:45pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eaedd{width:52.3pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eaee6{width:62.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eaee7{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce7eaee8{width:62.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-ce816938'><caption class="">Mean R-squared and RMSE of EONR Estimates by ML Methods and Modeling Scenarios</caption><thead><tr style="overflow-wrap:break-word;"><td class="cl-ce7eaebf"><p class="cl-ce7e866e"><span class="cl-ce7e7a8e">Model</span></p></td><td class="cl-ce7eaebe"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td  colspan="2"class="cl-ce7eaeb4"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">RF</span></p></td><td class="cl-ce7eaebe"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td  colspan="2"class="cl-ce7eaeb4"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">BRF</span></p></td><td class="cl-ce7eaebe"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td  colspan="2"class="cl-ce7eaeb4"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">CNN</span></p></td><td class="cl-ce7eaebe"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td  colspan="2"class="cl-ce7eaed2"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">CF-base</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ce7eaee6"><p class="cl-ce7e866e"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eaed3"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eaedd"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">RMSE</span></p></td><td class="cl-ce7eaee7"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">𝜋̂</span><span class="cl-ce7e7a98">loss</span></p></td><td class="cl-ce7eaed3"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eaedd"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">RMSE</span></p></td><td class="cl-ce7eaee7"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">𝜋̂</span><span class="cl-ce7e7a98">loss</span></p></td><td class="cl-ce7eaed3"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eaedd"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">RMSE</span></p></td><td class="cl-ce7eaee7"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">𝜋̂</span><span class="cl-ce7e7a98">loss</span></p></td><td class="cl-ce7eaed3"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eaee8"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">RMSE</span></p></td><td class="cl-ce7eaedc"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">𝜋̂</span><span class="cl-ce7e7a98">loss</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-ce7eae51"><p class="cl-ce7e866e"><span class="cl-ce7e7a8e">aby</span></p></td><td class="cl-ce7eae46"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae5a"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">45.3</span></p></td><td class="cl-ce7eae3c"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">29.39</span></p></td><td class="cl-ce7eae46"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae5a"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">39.5</span></p></td><td class="cl-ce7eae3c"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">22.52</span></p></td><td class="cl-ce7eae46"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae5a"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">62.8</span></p></td><td class="cl-ce7eae3c"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">58.99</span></p></td><td class="cl-ce7eae46"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae50"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">21.6</span></p></td><td class="cl-ce7eae64"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"> 4.92</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ce7eae51"><p class="cl-ce7e866e"><span class="cl-ce7e7a8e">abytt</span></p></td><td class="cl-ce7eae46"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae5a"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">47.2</span></p></td><td class="cl-ce7eae3c"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">32.12</span></p></td><td class="cl-ce7eae46"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae5a"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">39.0</span></p></td><td class="cl-ce7eae3c"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">22.20</span></p></td><td class="cl-ce7eae46"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae5a"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">62.8</span></p></td><td class="cl-ce7eae3c"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">58.99</span></p></td><td class="cl-ce7eae46"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae50"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">22.1</span></p></td><td class="cl-ce7eae64"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"> 5.11</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ce7eae51"><p class="cl-ce7e866e"><span class="cl-ce7e7a8e">aabbyy</span></p></td><td class="cl-ce7eae46"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae5a"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">49.6</span></p></td><td class="cl-ce7eae3c"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">35.80</span></p></td><td class="cl-ce7eae46"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae5a"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">40.6</span></p></td><td class="cl-ce7eae3c"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">23.74</span></p></td><td class="cl-ce7eae46"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae5a"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">62.8</span></p></td><td class="cl-ce7eae3c"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">58.99</span></p></td><td class="cl-ce7eae46"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae50"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">23.0</span></p></td><td class="cl-ce7eae64"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"> 5.60</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ce7eae51"><p class="cl-ce7e866e"><span class="cl-ce7e7a8e">aabbyytt</span></p></td><td class="cl-ce7eae46"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae5a"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">50.6</span></p></td><td class="cl-ce7eae3c"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">37.44</span></p></td><td class="cl-ce7eae46"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae5a"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">40.1</span></p></td><td class="cl-ce7eae3c"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">23.32</span></p></td><td class="cl-ce7eae46"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae5a"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">62.8</span></p></td><td class="cl-ce7eae3c"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">58.99</span></p></td><td class="cl-ce7eae46"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae50"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">23.1</span></p></td><td class="cl-ce7eae64"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"> 5.67</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ce7eae8c"><p class="cl-ce7e866e"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae65"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae6e"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae6f"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae65"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae6e"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae6f"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae65"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae6e"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae6f"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae65"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae78"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eae79"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ce7eae8d"><p class="cl-ce7e866e"><span class="cl-ce7e7a8e">Avg.</span></p></td><td class="cl-ce7eaea0"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eaea1"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">48.2</span></p></td><td class="cl-ce7eae96"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">33.69</span></p></td><td class="cl-ce7eaea0"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eaea1"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">39.8</span></p></td><td class="cl-ce7eae96"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">22.94</span></p></td><td class="cl-ce7eaea0"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eaea1"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">62.8</span></p></td><td class="cl-ce7eae96"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">58.99</span></p></td><td class="cl-ce7eaea0"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"></span></p></td><td class="cl-ce7eaeaa"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e">22.5</span></p></td><td class="cl-ce7eaea2"><p class="cl-ce7e8678"><span class="cl-ce7e7a8e"> 5.33</span></p></td></tr></tbody></table></div>

<br>

<br>


<div class="tabwid"><style>.cl-ce861910{border-collapse:collapse;}.cl-ce83ecd0{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ce83f27a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ce83f284{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ce840774{width:54.2pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce84077e{width:62.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce840788{width:65.2pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce840789{width:54.2pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce840792{width:62.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce840793{width:65.2pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce84079c{width:65.2pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce84079d{width:54.2pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce8407a6{width:62.1pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce8407a7{width:62.1pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce8407b0{width:54.2pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce8407b1{width:65.2pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-ce861910'><caption class="">Mean R-squared and RMSE of Predicted Yield by ML Methods and Modeling Scenarios</caption><thead><tr style="overflow-wrap:break-word;"><td class="cl-ce8407a7"><p class="cl-ce83f27a"><span class="cl-ce83ecd0">Model</span></p></td><td class="cl-ce8407b0"><p class="cl-ce83f284"><span class="cl-ce83ecd0">RF</span></p></td><td class="cl-ce8407b0"><p class="cl-ce83f284"><span class="cl-ce83ecd0">BRF</span></p></td><td class="cl-ce8407b0"><p class="cl-ce83f284"><span class="cl-ce83ecd0">CNN</span></p></td><td class="cl-ce8407b1"><p class="cl-ce83f284"><span class="cl-ce83ecd0">CF_base</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-ce84077e"><p class="cl-ce83f27a"><span class="cl-ce83ecd0">aby</span></p></td><td class="cl-ce840774"><p class="cl-ce83f284"><span class="cl-ce83ecd0">1315.9</span></p></td><td class="cl-ce840774"><p class="cl-ce83f284"><span class="cl-ce83ecd0">1316.5</span></p></td><td class="cl-ce840774"><p class="cl-ce83f284"><span class="cl-ce83ecd0">1368.8</span></p></td><td class="cl-ce840788"><p class="cl-ce83f284"><span class="cl-ce83ecd0">-</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ce84077e"><p class="cl-ce83f27a"><span class="cl-ce83ecd0">abytt</span></p></td><td class="cl-ce840774"><p class="cl-ce83f284"><span class="cl-ce83ecd0">1340.6</span></p></td><td class="cl-ce840774"><p class="cl-ce83f284"><span class="cl-ce83ecd0">1345.9</span></p></td><td class="cl-ce840774"><p class="cl-ce83f284"><span class="cl-ce83ecd0">1426.2</span></p></td><td class="cl-ce840788"><p class="cl-ce83f284"><span class="cl-ce83ecd0">-</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ce84077e"><p class="cl-ce83f27a"><span class="cl-ce83ecd0">aabbyy</span></p></td><td class="cl-ce840774"><p class="cl-ce83f284"><span class="cl-ce83ecd0">1452.1</span></p></td><td class="cl-ce840774"><p class="cl-ce83f284"><span class="cl-ce83ecd0">1398.2</span></p></td><td class="cl-ce840774"><p class="cl-ce83f284"><span class="cl-ce83ecd0">1426.5</span></p></td><td class="cl-ce840788"><p class="cl-ce83f284"><span class="cl-ce83ecd0">-</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ce84077e"><p class="cl-ce83f27a"><span class="cl-ce83ecd0">aabbyytt</span></p></td><td class="cl-ce840774"><p class="cl-ce83f284"><span class="cl-ce83ecd0">1478.8</span></p></td><td class="cl-ce840774"><p class="cl-ce83f284"><span class="cl-ce83ecd0">1408.2</span></p></td><td class="cl-ce840774"><p class="cl-ce83f284"><span class="cl-ce83ecd0">1473.3</span></p></td><td class="cl-ce840788"><p class="cl-ce83f284"><span class="cl-ce83ecd0">-</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ce840792"><p class="cl-ce83f27a"><span class="cl-ce83ecd0"></span></p></td><td class="cl-ce840789"><p class="cl-ce83f284"><span class="cl-ce83ecd0"></span></p></td><td class="cl-ce840789"><p class="cl-ce83f284"><span class="cl-ce83ecd0"></span></p></td><td class="cl-ce840789"><p class="cl-ce83f284"><span class="cl-ce83ecd0"></span></p></td><td class="cl-ce840793"><p class="cl-ce83f284"><span class="cl-ce83ecd0"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ce8407a6"><p class="cl-ce83f27a"><span class="cl-ce83ecd0">Avg.</span></p></td><td class="cl-ce84079d"><p class="cl-ce83f284"><span class="cl-ce83ecd0">1396.9</span></p></td><td class="cl-ce84079d"><p class="cl-ce83f284"><span class="cl-ce83ecd0">1367.2</span></p></td><td class="cl-ce84079d"><p class="cl-ce83f284"><span class="cl-ce83ecd0">1423.7</span></p></td><td class="cl-ce84079c"><p class="cl-ce83f284"><span class="cl-ce83ecd0">-</span></p></td></tr></tbody></table></div>

\newpage


<div class="tabwid"><style>.cl-ce8a8180{border-collapse:collapse;}.cl-ce8863f0{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ce88697c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ce886986{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-ce887d22{width:67.6pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce887d2c{width:55.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce887d36{width:62.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce887d37{width:45pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce887d40{width:67.6pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce887d41{width:55.4pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce887d4a{width:62.1pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce887d54{width:45pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce887d55{width:67.6pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce887d56{width:55.4pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce887d5e{width:62.1pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ce887d5f{width:45pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-ce8a8180'><caption class="">Count table about the number of simulation rounds where an identical ML method showed the highest R-squared in both EONR estimation and yield prediction in that round. The number in ( ) indicates the number of simulation rounds with the highest R-squared in Yield Prediction.</caption><thead><tr style="overflow-wrap:break-word;"><td class="cl-ce887d5e"><p class="cl-ce88697c"><span class="cl-ce8863f0">Model</span></p></td><td class="cl-ce887d56"><p class="cl-ce886986"><span class="cl-ce8863f0">RF</span></p></td><td class="cl-ce887d55"><p class="cl-ce886986"><span class="cl-ce8863f0">BRF</span></p></td><td class="cl-ce887d56"><p class="cl-ce886986"><span class="cl-ce8863f0">CNN</span></p></td><td class="cl-ce887d5f"><p class="cl-ce886986"><span class="cl-ce8863f0">Total</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-ce887d36"><p class="cl-ce88697c"><span class="cl-ce8863f0">aby</span></p></td><td class="cl-ce887d2c"><p class="cl-ce886986"><span class="cl-ce8863f0">7 (397)</span></p></td><td class="cl-ce887d22"><p class="cl-ce886986"><span class="cl-ce8863f0">349 (356)</span></p></td><td class="cl-ce887d2c"><p class="cl-ce886986"><span class="cl-ce8863f0">0 (247)</span></p></td><td class="cl-ce887d37"><p class="cl-ce886986"><span class="cl-ce8863f0">356</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ce887d36"><p class="cl-ce88697c"><span class="cl-ce8863f0">abytt</span></p></td><td class="cl-ce887d2c"><p class="cl-ce886986"><span class="cl-ce8863f0">0 (472)</span></p></td><td class="cl-ce887d22"><p class="cl-ce886986"><span class="cl-ce8863f0">329 (329)</span></p></td><td class="cl-ce887d2c"><p class="cl-ce886986"><span class="cl-ce8863f0">0 (199)</span></p></td><td class="cl-ce887d37"><p class="cl-ce886986"><span class="cl-ce8863f0">329</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ce887d36"><p class="cl-ce88697c"><span class="cl-ce8863f0">aabbyy</span></p></td><td class="cl-ce887d2c"><p class="cl-ce886986"><span class="cl-ce8863f0">0 (176)</span></p></td><td class="cl-ce887d22"><p class="cl-ce886986"><span class="cl-ce8863f0">430 (430)</span></p></td><td class="cl-ce887d2c"><p class="cl-ce886986"><span class="cl-ce8863f0">0 (394)</span></p></td><td class="cl-ce887d37"><p class="cl-ce886986"><span class="cl-ce8863f0">430</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-ce887d4a"><p class="cl-ce88697c"><span class="cl-ce8863f0">aabbyytt</span></p></td><td class="cl-ce887d41"><p class="cl-ce886986"><span class="cl-ce8863f0">0 (199)</span></p></td><td class="cl-ce887d40"><p class="cl-ce886986"><span class="cl-ce8863f0">504 (504)</span></p></td><td class="cl-ce887d41"><p class="cl-ce886986"><span class="cl-ce8863f0">0 (297)</span></p></td><td class="cl-ce887d54"><p class="cl-ce886986"><span class="cl-ce8863f0">504</span></p></td></tr></tbody></table></div>

\newpage

<br>

<br>


\newpage


# Figures
<!-- 
1. add the distribution of the resutls
2. add the distribution of each parameters -->
<!-- when you mention a figure, use "Figure \@ref(fig:fig-1)"  -->

<embed src="/Users/shunkeikakimoto/OneDrive - University of Nebraska-Lincoln/ML_VRA_2/GitControlled/Writing/JournalSubmission/ctree_ex.pdf" title="An Illustrative Example of Causal Tree" alt="An Illustrative Example of Causal Tree" style="display: block; margin: auto;" type="application/pdf" />

<img src="figure/field-map-1.png" title="Division of Field: plots, subplots and cells" alt="Division of Field: plots, subplots and cells" width="504" style="display: block; margin: auto;" />

<img src="figure/fig-parameters-1.png" title="An Illustrative Example of Spatial Distributions of Field Charateristics" alt="An Illustrative Example of Spatial Distributions of Field Charateristics" width="648" style="display: block; margin: auto;" />


<img src="figure/fig-optN-1.png" title="An Illustrative Example of a Spatial Distribution of True Optimal N Rate" alt="An Illustrative Example of a Spatial Distribution of True Optimal N Rate" width="504" style="display: block; margin: auto;" />

<!-- \newpage -->


<img src="figure/fig-nExp-1.png" title="An Illustrative Example of Experimental Design of N" alt="An Illustrative Example of Experimental Design of N" width="504" style="display: block; margin: auto;" />


<img src="figure/field-yield-cell-1.png" title="An Illustrative Example of a Yield Distribution Map at the cell resolution" alt="An Illustrative Example of a Yield Distribution Map at the cell resolution" width="504" style="display: block; margin: auto;" />

<img src="figure/field-yield-subplot-1.png" title="An Illustrative Example of a Yield Distribution Map at the subplot resolution" alt="An Illustrative Example of a Yield Distribution Map at the subplot resolution" width="504" style="display: block; margin: auto;" />


<img src="figure/dist-optN-1.png" title="Distributions of RMSE for EONR over Simulations" alt="Distributions of RMSE for EONR over Simulations" width="504" style="display: block; margin: auto;" />

<img src="figure/dist-piLoss-1.png" title="Distributions of Profit Loss over Simulations" alt="Distributions of Profit Loss over Simulations" width="504" style="display: block; margin: auto;" />


<img src="figure/plot-tre-1.png" title="True Treatment Effect vs Estimated Treatment Effect (aabbyytt case)" alt="True Treatment Effect vs Estimated Treatment Effect (aabbyytt case)" width="576" style="display: block; margin: auto;" />

<img src="figure/plot-y-optN-1.png" title="R-squared of EONR prediction against R-squared of yield prediction" alt="R-squared of EONR prediction against R-squared of yield prediction" width="576" style="display: block; margin: auto;" />


\newpage


# Apepndix


## CF-stepwise and CF-base

<!-- For estimating site-specific EONR, the trained CF-base and CF-stepwise methods were used to make predictions of site-specific changes in yields resultant from changes in application rates from $N_1$ to $N_m$ $(m\in\{2,3,4,5\})$. Let $\Delta Y_{N_1 \rightarrow N_m}(\mathbf{\Omega^{i}})$ be the the estimated treatment effect of changing subplot $i$'s application rate from $N_1$ to $N_m$ for site $i$. 
In the CF-stepwise approach, this value can be calculated by sequentially adding the estimated treatment effects:  -->
While CF-base always used $N_1$ as as $N^{con}$, the grouping approach of CF-stepwise used $(N_1, N_2),(N_2, N_3),(N_3, N_4)$, and $(N_4, N_5)$. Under this set of N application rate combinations, the change in yields from the yield at $N_1$ can be calculated by sequentially adding the estimated treatment effects:

$$
\Delta Y_{N_1 \rightarrow N_m}(\mathbf{\Omega^{i}}) = \sum_{k=1}^{m-1} \hat{\tau}_{N_{k} \rightarrow N_{k+1}}(\mathbf{\Omega^{i}})
$$

Then, site-specific EONRs were identified in the same manner as CF-base approach. 

Table \@ref(tab:table-optN-CF) compare the performance of CF-stepwise with that of CF-base in terms of the mean RMSE of the EONR estimation and $\hat{\pi}_{loss}$ over the $1000$ simulations. CF-stepwise showed the comparable performance to CF-base. Figure \@ref(fig:plot_dis_CF_optN) illustrates the distributions of the mean RMSE of the EONR estimation. Overall, the distributions of CF-base have longer right tail than the distributions of CF-stepwise, meaning that CF-base suffered from some large errors compared to CF-stepwise. Meanwhile, when looking at the distributions of mean $\hat{\pi}_{loss}$, it turns out that CF-base more accurately and consistently estimated EONR which lead to the profits close to the maximized profits.
By nature, RMSE gives a relatively high weight to large errors. However, even though CF-base incur the some such larger prediction errors compared to CF-stepwise, those errors may not have economically significant consequences, and the results suggest that overall the EONR estimates from CF-base are more accurate and consistent than CF-stepwise to derive higher profit. Hence, we conclude that CF-base is preferred CF-based method to CF-stepwise.

<!-- Even though CF-stepwise and CF-base used the same ML method, the performance of CF-stepwise was considerably poorer than CF-base's. To examine this problem in more detail we conducted simulations to investigate how accurately CF-stepwise and CF-base can predict the treatment effects for each $(N^{con}, N^{tre})$ combination on independent validation data sets. We used the same data and ran $1000$ rounds of simulations. In each simulation round, the R-squared of estimated treatment effects was calculated. Table \@ref(tab:te-res-summary) reports the resultant mean of R-squared. While the accuracy of treatment effect estimation from CF-base improves as N treatment rates increases, the accuracy of CF-stepwise became gradually worse. 

Generally, the slope of the yield response curve to N rate diminishes as N rate increases, and the shape of the curve starts to almost flatten out around the high N application rate of $N_4$ and $N_5$. Consequently, the observed differences in yield between two successive N rates are progressively dominated by noise rather than by the treatment effect signal, making it progressively harder as the N rate increases for CF-stepwise to estimate the treatment effects. On the other hand, the arrangement of treatment groups by CF-base provides sufficient signaling because the baseline N rate is always the lowest N rate.
 -->


\newpage 


# Table

<div class="tabwid"><style>.cl-df707982{border-collapse:collapse;}.cl-df6de91a{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-df6de92e{font-family:'Helvetica';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;top:3.3pt;}.cl-df6def3c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-df6def46{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-df6e097c{width:62.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e0986{width:45pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e0990{width:21.6pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e0991{width:62.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e099a{width:81.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e09a4{width:21.6pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e09a5{width:62.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e09ae{width:81.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e09b8{width:45pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e09b9{width:62.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e09c2{width:21.6pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e09cc{width:62.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e09d6{width:62.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e09d7{width:45pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e09e0{width:81.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e09ea{width:81.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e09eb{width:62.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e09f4{width:45pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e09f5{width:62.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e09fe{width:21.6pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e09ff{width:62.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e0a08{width:45pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e0a09{width:81.7pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e0a12{width:21.6pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df6e0a13{width:62.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-df707982'><caption class="">Mean R-squared and RMSE of EONR Estimates by ML Methods and Modeling Scenarios</caption><thead><tr style="overflow-wrap:break-word;"><td class="cl-df6e09eb"><p class="cl-df6def3c"><span class="cl-df6de91a">Model</span></p></td><td class="cl-df6e09fe"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td  colspan="2"class="cl-df6e09f5"><p class="cl-df6def46"><span class="cl-df6de91a">CF-base</span></p></td><td class="cl-df6e09fe"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td  colspan="2"class="cl-df6e09ea"><p class="cl-df6def46"><span class="cl-df6de91a">CF-stepwise</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-df6e0a13"><p class="cl-df6def3c"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e0a12"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e09ff"><p class="cl-df6def46"><span class="cl-df6de91a">RMSE</span></p></td><td class="cl-df6e0a08"><p class="cl-df6def46"><span class="cl-df6de91a">𝜋̂</span><span class="cl-df6de92e">loss</span></p></td><td class="cl-df6e0a12"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e0a09"><p class="cl-df6def46"><span class="cl-df6de91a">RMSE</span></p></td><td class="cl-df6e0a08"><p class="cl-df6def46"><span class="cl-df6de91a">𝜋̂</span><span class="cl-df6de92e">loss</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-df6e097c"><p class="cl-df6def3c"><span class="cl-df6de91a">aby</span></p></td><td class="cl-df6e0990"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e0991"><p class="cl-df6def46"><span class="cl-df6de91a">21.6</span></p></td><td class="cl-df6e0986"><p class="cl-df6def46"><span class="cl-df6de91a"> 4.92</span></p></td><td class="cl-df6e0990"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e099a"><p class="cl-df6def46"><span class="cl-df6de91a">21.3</span></p></td><td class="cl-df6e0986"><p class="cl-df6def46"><span class="cl-df6de91a"> 5.17</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-df6e097c"><p class="cl-df6def3c"><span class="cl-df6de91a">abytt</span></p></td><td class="cl-df6e0990"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e0991"><p class="cl-df6def46"><span class="cl-df6de91a">22.1</span></p></td><td class="cl-df6e0986"><p class="cl-df6def46"><span class="cl-df6de91a"> 5.11</span></p></td><td class="cl-df6e0990"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e099a"><p class="cl-df6def46"><span class="cl-df6de91a">21.8</span></p></td><td class="cl-df6e0986"><p class="cl-df6def46"><span class="cl-df6de91a"> 5.40</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-df6e097c"><p class="cl-df6def3c"><span class="cl-df6de91a">aabbyy</span></p></td><td class="cl-df6e0990"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e0991"><p class="cl-df6def46"><span class="cl-df6de91a">23.0</span></p></td><td class="cl-df6e0986"><p class="cl-df6def46"><span class="cl-df6de91a"> 5.60</span></p></td><td class="cl-df6e0990"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e099a"><p class="cl-df6def46"><span class="cl-df6de91a">22.6</span></p></td><td class="cl-df6e0986"><p class="cl-df6def46"><span class="cl-df6de91a"> 5.82</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-df6e097c"><p class="cl-df6def3c"><span class="cl-df6de91a">aabbyytt</span></p></td><td class="cl-df6e0990"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e0991"><p class="cl-df6def46"><span class="cl-df6de91a">23.1</span></p></td><td class="cl-df6e0986"><p class="cl-df6def46"><span class="cl-df6de91a"> 5.67</span></p></td><td class="cl-df6e0990"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e099a"><p class="cl-df6def46"><span class="cl-df6de91a">22.6</span></p></td><td class="cl-df6e0986"><p class="cl-df6def46"><span class="cl-df6de91a"> 5.80</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-df6e09b9"><p class="cl-df6def3c"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e09a4"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e09a5"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e09b8"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e09a4"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e09ae"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e09b8"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-df6e09cc"><p class="cl-df6def3c"><span class="cl-df6de91a">Avg.</span></p></td><td class="cl-df6e09c2"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e09d6"><p class="cl-df6def46"><span class="cl-df6de91a">22.5</span></p></td><td class="cl-df6e09d7"><p class="cl-df6def46"><span class="cl-df6de91a"> 5.33</span></p></td><td class="cl-df6e09c2"><p class="cl-df6def46"><span class="cl-df6de91a"></span></p></td><td class="cl-df6e09e0"><p class="cl-df6def46"><span class="cl-df6de91a">22.1</span></p></td><td class="cl-df6e09d7"><p class="cl-df6def46"><span class="cl-df6de91a"> 5.55</span></p></td></tr></tbody></table></div>

<br>

<br>



<div class="tabwid"><style>.cl-df75685c{border-collapse:collapse;}.cl-df730cf6{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-df730d00{font-family:'Helvetica';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-df731336{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-df731340{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-df73289e{width:65.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df7328a8{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df7328a9{width:81.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df7328b2{width:65.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df7328bc{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df7328bd{width:81.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df7328c6{width:81.7pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df7328d0{width:65.1pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df7328da{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df7328db{width:81.7pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df7328e4{width:65.1pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df7328ee{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-df75685c'><caption class="">The Performance of Treatment Effect Estimation by CF-stepwise and CF-base in aby modeling scenario</caption><thead><tr style="overflow-wrap:break-word;"><td class="cl-df7328db"><p class="cl-df731336"><span class="cl-df730cf6">Method</span></p></td><td class="cl-df7328e4"><p class="cl-df731340"><span class="cl-df730cf6">(N</span><span class="cl-df730d00">con</span><span class="cl-df730cf6">, N</span><span class="cl-df730d00">tre</span><span class="cl-df730cf6">)</span></p></td><td class="cl-df7328ee"><p class="cl-df731340"><span class="cl-df730cf6">R</span><span class="cl-df730d00">2</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-df7328a9"><p class="cl-df731336"><span class="cl-df730cf6">CF-stepwise</span></p></td><td class="cl-df73289e"><p class="cl-df731340"><span class="cl-df730cf6">(N1,N2)</span></p></td><td class="cl-df7328a8"><p class="cl-df731340"><span class="cl-df730cf6">0.684</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-df7328a9"><p class="cl-df731336"><span class="cl-df730cf6">CF-stepwise</span></p></td><td class="cl-df73289e"><p class="cl-df731340"><span class="cl-df730cf6">(N2,N3)</span></p></td><td class="cl-df7328a8"><p class="cl-df731340"><span class="cl-df730cf6">0.663</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-df7328a9"><p class="cl-df731336"><span class="cl-df730cf6">CF-stepwise</span></p></td><td class="cl-df73289e"><p class="cl-df731340"><span class="cl-df730cf6">(N3,N4)</span></p></td><td class="cl-df7328a8"><p class="cl-df731340"><span class="cl-df730cf6">0.555</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-df7328a9"><p class="cl-df731336"><span class="cl-df730cf6">CF-stepwise</span></p></td><td class="cl-df73289e"><p class="cl-df731340"><span class="cl-df730cf6">(N4,N5)</span></p></td><td class="cl-df7328a8"><p class="cl-df731340"><span class="cl-df730cf6">0.422</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-df7328bd"><p class="cl-df731336"><span class="cl-df730cf6">CF-base</span></p></td><td class="cl-df7328b2"><p class="cl-df731340"><span class="cl-df730cf6">(N1,N2)</span></p></td><td class="cl-df7328bc"><p class="cl-df731340"><span class="cl-df730cf6">0.685</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-df7328bd"><p class="cl-df731336"><span class="cl-df730cf6">CF-base</span></p></td><td class="cl-df7328b2"><p class="cl-df731340"><span class="cl-df730cf6">(N1,N3)</span></p></td><td class="cl-df7328bc"><p class="cl-df731340"><span class="cl-df730cf6">0.789</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-df7328bd"><p class="cl-df731336"><span class="cl-df730cf6">CF-base</span></p></td><td class="cl-df7328b2"><p class="cl-df731340"><span class="cl-df730cf6">(N1,N4)</span></p></td><td class="cl-df7328bc"><p class="cl-df731340"><span class="cl-df730cf6">0.823</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-df7328c6"><p class="cl-df731336"><span class="cl-df730cf6">CF-base</span></p></td><td class="cl-df7328d0"><p class="cl-df731340"><span class="cl-df730cf6">(N1,N5)</span></p></td><td class="cl-df7328da"><p class="cl-df731340"><span class="cl-df730cf6">0.836</span></p></td></tr></tbody></table></div>

# Figures

<img src="figure/dist-optN-CF-1.png" title="Distributions of RMSE for EONR over Simulations" alt="Distributions of RMSE for EONR over Simulations" width="504" style="display: block; margin: auto;" />


<img src="figure/dist-piLoss-CF-1.png" title="Distributions of Profit Loss over Simulations" alt="Distributions of Profit Loss over Simulations" width="504" style="display: block; margin: auto;" />


\newpage 


# References

<div id="refs"></div>












